

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Enrutando &mdash; symfony-docs-es v1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="symfony-docs-es v1 documentation" href="../index.html" />
    <link rel="up" title="Libro" href="index.html" />
    <link rel="next" title="Creando y usando plantillas" href="templating.html" />
    <link rel="prev" title="Controlador" href="controller.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="templating.html" title="Creando y usando plantillas"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="controller.html" title="Controlador"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">symfony-docs-es v1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Libro</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="enrutando">
<span id="index-0"></span><h1>Enrutando<a class="headerlink" href="#enrutando" title="Permalink to this headline">¶</a></h1>
<p>Las URL bonitas absolutamente son una necesidad para cualquier aplicación web seria. Esto significa dejar atrás las URL feas como <tt class="docutils literal"><span class="pre">index.php?id_articulo=57</span></tt> en favor de algo así como <tt class="docutils literal"><span class="pre">/leer/intro-a-symfony</span></tt>.</p>
<p>Tener tal flexibilidad es más importante aún. ¿Qué pasa si necesitas cambiar la URL de una página de <tt class="docutils literal"><span class="pre">/blog</span></tt> a <tt class="docutils literal"><span class="pre">/noticias</span></tt>? ¿Cuántos enlaces necesitas cazar y actualizar para hacer el cambio? Si estás utilizando el enrutador de Symfony, el cambio es sencillo.</p>
<p>El enrutador de Symfony2 te permite definir direcciones URL creativas que se asignan a diferentes áreas de la aplicación. Al final de este capítulo, serás capaz de:</p>
<ul class="simple">
<li>Crear rutas complejas asignadas a controladores</li>
<li>Generar URL dentro de plantillas y controladores</li>
<li>Cargar recursos enrutando desde el paquete (o en cualquier otro lugar)</li>
<li>Depurar tus rutas</li>
</ul>
<div class="section" id="enrutador-en-accion">
<span id="index-1"></span><h2>Enrutador en acción<a class="headerlink" href="#enrutador-en-accion" title="Permalink to this headline">¶</a></h2>
<p>Una <em>ruta</em> es un mapa desde un patrón URL hasta un controlador. Por ejemplo, supongamos que deseas adaptar cualquier URL como <tt class="docutils literal"><span class="pre">/blog/mi-post</span></tt> o <tt class="docutils literal"><span class="pre">/blog/todo-sobre-symfony</span></tt> y enviarla a un controlador que puede buscar y reproducir esta entrada del blog.
La ruta es simple:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/routing.yml</span>
<span class="l-Scalar-Plain">blog_show</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{ficha}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">show</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- app/config/routing.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog_show&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{ficha}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:show<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">// app/config/routing.php</span>
<span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog_show&#39;, new Route(&#39;/blog/{ficha}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:show&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>El patrón definido por la ruta <tt class="docutils literal"><span class="pre">blog_show</span></tt> actúa como <tt class="docutils literal"><span class="pre">/blog/*</span></tt> dónde al comodín se le da el nombre de <tt class="docutils literal"><span class="pre">ficha</span></tt>. Para la URL <tt class="docutils literal"><span class="pre">/blog/mi-entrada-del-blog</span></tt>, la variable <tt class="docutils literal"><span class="pre">ficha</span></tt> obtiene un valor de <tt class="docutils literal"><span class="pre">mi-entrada-del-blog</span></tt>, que está disponible para usarla en el controlador (sigue leyendo).</p>
<p>El parámetro <tt class="docutils literal"><span class="pre">_controller</span></tt> es una clave especial que le dice a Symfony qué controlador se debe ejecutar cuando una URL coincide con esta ruta. La cadena <tt class="docutils literal"><span class="pre">_controller</span></tt> se conoce como el <a class="reference internal" href="#controller-string-syntax"><em>nombre lógico</em></a>. Esta sigue un patrón que apunta hacia una clase PHP y un método:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">// src/Acme/BlogBundle/Controller/BlogController.php</span>

<span class="x">namespace Acme/BlogBundle/Controller;</span>
<span class="x">use Symfony\Bundle\FrameworkBundle\Controller\Controller;</span>

<span class="x">class BlogController extends Controller</span>
<span class="x">{</span>
<span class="x">    public function showAction($ficha)</span>
<span class="x">    {</span>
<span class="x">        $blog = // usa la variable $ficha para consultar la base de datos</span>

<span class="x">        return $this-&gt;render(&#39;AcmeBlogBundle:Blog:show.html.twig&#39;, array(</span>
<span class="x">            &#39;blog&#39; =&gt; $blog,</span>
<span class="x">        ));</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
</div>
<p>¡Enhorabuena! Acabas de crear tu primera ruta y la conectaste a un controlador. Ahora, cuando visites <tt class="docutils literal"><span class="pre">/blog/mi-comentario</span></tt>, el controlador <tt class="docutils literal"><span class="pre">showAction</span></tt> será ejecutado y la variable <tt class="docutils literal"><span class="pre">$ficha</span></tt> será igual a <tt class="docutils literal"><span class="pre">mi-comentario</span></tt>.</p>
<p>Este es el objetivo del enrutador de Symfony2: asignar la URL de una petición a un controlador. De paso, aprenderás todo tipo de trucos que incluso facilitan la asignación de direcciones URL complejas.</p>
</div>
<div class="section" id="enrutador-bajo-el-capo">
<span id="index-2"></span><h2>Enrutador: bajo el capó<a class="headerlink" href="#enrutador-bajo-el-capo" title="Permalink to this headline">¶</a></h2>
<p>Cuando se hace una petición a tu aplicación, esta contiene una dirección al &#8220;recurso&#8221; exacto que solicitó el cliente. Esta dirección se conoce como URL (o URI), y podría ser <tt class="docutils literal"><span class="pre">/contacto</span></tt>, <tt class="docutils literal"><span class="pre">/blog/leeme</span></tt>, o cualquier otra cosa. Tomemos la siguiente petición HTTP, por ejemplo:</p>
<div class="highlight-text"><div class="highlight"><pre>GET /blog/mi-entrada-del-blog
</pre></div>
</div>
<p>El objetivo del sistema de enrutado de Symfony2 es analizar esta URL y determinar qué controlador se debe ejecutar. Todo el proceso es el siguiente:</p>
<ol class="arabic simple">
<li>La petición es manejada por el controlador frontal de Symfony2 (por ejemplo, <tt class="docutils literal"><span class="pre">app.php</span></tt>);</li>
<li>El núcleo de Symfony2 (es decir, el Kernel) pregunta al enrutador que examine la petición;</li>
<li>El enrutador busca la URL entrante para emparejarla con una ruta específica y devuelve información sobre la ruta, incluyendo el controlador que se debe ejecutar;</li>
<li>El núcleo de Symfony2 ejecuta el controlador, que en última instancia, devuelve un objeto <tt class="docutils literal"><span class="pre">Respuesta</span></tt>.</li>
</ol>
<div class="figure align-center">
<img alt="flujo de la petición en Symfony2" src="../_images/flujo-peticion.png" />
<p class="caption">La capa del enrutador es una herramienta que traduce la URL entrante a un controlador específico a ejecutar.</p>
</div>
</div>
<div class="section" id="creando-rutas">
<span id="index-3"></span><h2>Creando rutas<a class="headerlink" href="#creando-rutas" title="Permalink to this headline">¶</a></h2>
<p>Symfony carga todas las rutas de tu aplicación desde un archivo de configuración de enrutado. El archivo usualmente es <tt class="docutils literal"><span class="pre">app/config/routing.yml</span></tt>, pero lo puedes configurar para que sea cualquier otro (incluyendo un archivo XML o PHP) vía el archivo de configuración de la aplicación:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">framework</span><span class="p-Indicator">:</span>
    <span class="c1"># ...</span>
    <span class="l-Scalar-Plain">router</span><span class="p-Indicator">:</span>        <span class="p-Indicator">{</span> <span class="nv">resource</span><span class="p-Indicator">:</span> <span class="s">&quot;%kernel.root_dir%/config/routing.yml&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><pre>&lt;!-- app/config/config.xml --&gt;
&lt;framework:config ...&gt;
    &lt;!-- ... --&gt;
    &lt;framework:router resource="%kernel.root_dir%/config/routing.xml" /&gt;
&lt;/framework:config&gt;</pre>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">// app/config/config.php</span>
<span class="x">$contenedor-&gt;loadFromExtension(&#39;framework&#39;, array(</span>
<span class="x">    // ...</span>
<span class="x">    &#39;router&#39;        =&gt; array(&#39;resource&#39; =&gt; &#39;%kernel.root_dir%/config/routing.php&#39;),</span>
<span class="x">));</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A pesar de que todas las rutas se cargan desde un solo archivo, es práctica común incluir recursos de enrutado adicionales desde el interior del archivo. Consulta la sección <a class="reference internal" href="#routing-include-external-resources"><em>Incluyendo recursos de enrutado externos</em></a> para más información.</p>
</div>
</div>
</div>
<div class="section" id="configuracion-basica-de-rutas">
<h1>Configuración básica de rutas<a class="headerlink" href="#configuracion-basica-de-rutas" title="Permalink to this headline">¶</a></h1>
<p>Definir una ruta es fácil, y una aplicación típica tendrá un montón de rutas.
Una ruta básica consta de dos partes: el <tt class="docutils literal"><span class="pre">patrón</span></tt> a coincidir y un arreglo <tt class="docutils literal"><span class="pre">defaults</span></tt>:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">_bienvenida</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Principal</span><span class="p-Indicator">:</span><span class="nv">portada</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;_bienvenida&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeDemoBundle:Principal:portada<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>

<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;_bienvenida&#39;, new Route(&#39;/&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeDemoBundle:Principal:portada&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Esta ruta coincide con la página de inicio (<tt class="docutils literal"><span class="pre">/</span></tt>) y la asigna al controlador de la página principal <tt class="docutils literal"><span class="pre">AcmeDemoBundle:Principal:portada</span></tt>. Symfony2 convierte la cadena <tt class="docutils literal"><span class="pre">_controller</span></tt> en una función PHP real y la ejecuta. Este proceso será explicado en breve en la sección <a class="reference internal" href="#controller-string-syntax"><em>Patrón de nomenclatura para controladores</em></a>.</p>
</div>
<div class="section" id="enrutando-con-marcadores-de-posicion">
<span id="index-4"></span><h1>Enrutando con marcadores de posición<a class="headerlink" href="#enrutando-con-marcadores-de-posicion" title="Permalink to this headline">¶</a></h1>
<p>Por supuesto, el sistema de enrutado es compatible con rutas mucho más interesantes. Muchas rutas contienen uno o más &#8220;comodines&#8221; llamados marcadores de posición:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">blog_show</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{ficha}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">show</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog_show&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{ficha}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:show<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog_show&#39;, new Route(&#39;/blog/{ficha}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:show&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>El patrón coincidirá con cualquier cosa que se vea como <tt class="docutils literal"><span class="pre">/blog/*</span></tt>. Aún mejor, el valor coincide con el marcador de posición <tt class="docutils literal"><span class="pre">{ficha}</span></tt> que estará disponible dentro de tu controlador. En otras palabras, si la URL es <tt class="docutils literal"><span class="pre">/blog/hola-mundo</span></tt>, una variable <tt class="docutils literal"><span class="pre">$ficha</span></tt>, con un valor de <tt class="docutils literal"><span class="pre">hola-mundo</span></tt>, estará disponible en el controlador.
Esta se puede usar, por ejemplo, para cargar la entrada en el blog coincidente con esa cadena.</p>
<p>El patrón <em>no</em> es, sin embargo, simplemente una coincidencia con <tt class="docutils literal"><span class="pre">/blog</span></tt>. Eso es porque, por omisión, todos los marcadores de posición son obligatorios. Esto se puede cambiar agregando un valor marcador de posición al arreglo <tt class="docutils literal"><span class="pre">defaults</span></tt>.</p>
</div>
<div class="section" id="marcadores-de-posicion-obligatorios-y-opcionales">
<h1>Marcadores de posición obligatorios y opcionales<a class="headerlink" href="#marcadores-de-posicion-obligatorios-y-opcionales" title="Permalink to this headline">¶</a></h1>
<p>Para hacer las cosas más emocionantes, añade una nueva ruta que muestre una lista de todas las entradas del &#8216;blog&#8217; para la petición imaginaria &#8216;blog&#8217;:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">blog</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">index</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:index<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog&#39;, new Route(&#39;/blog&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:index&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Hasta el momento, esta ruta es tan simple como es posible - no contiene marcadores de posición y sólo coincidirá con la URL exacta <tt class="docutils literal"><span class="pre">/blog</span></tt>. ¿Pero si necesitamos que esta ruta sea compatible con paginación, donde <tt class="docutils literal"><span class="pre">/blog/2</span></tt> muestra la segunda página de las entradas del blog? Actualiza la ruta para que tenga un nuevo marcador de posición <tt class="docutils literal"><span class="pre">{pag}</span></tt>:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">blog</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{pag}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">index</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{pag}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:index<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog&#39;, new Route(&#39;/blog/{pag}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:index&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Al igual que el marcador de posición <tt class="docutils literal"><span class="pre">{ficha}</span></tt> anterior, el valor coincidente con <tt class="docutils literal"><span class="pre">{pag}</span></tt> estará disponible dentro de tu controlador. Puedes utilizar su valor para determinar cual conjunto de entradas del blog muestra determinada página.</p>
<p>¡Pero espera! Puesto que los marcadores de posición de forma predeterminada son obligatorios, esta ruta ya no coincidirá con <tt class="docutils literal"><span class="pre">/blog</span></tt> simplemente. En su lugar, para ver la página 1 del blog, ¡habrá la necesidad de utilizar la URL <tt class="docutils literal"><span class="pre">/blog/1</span></tt>! Debido a que esa no es la manera en que se comporta una aplicación web rica, debes modificar la ruta para que el parámetro <tt class="docutils literal"><span class="pre">{pag}</span></tt> sea opcional.
Esto se consigue incluyendo la colección <tt class="docutils literal"><span class="pre">defaults</span></tt>:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">blog</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{pag}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">index</span><span class="p-Indicator">,</span> <span class="nv">pag</span><span class="p-Indicator">:</span> <span class="nv">1</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{pag}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:index<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;pag&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog&#39;, new Route(&#39;/blog/{pag}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:index&#39;,</span>
<span class="x">    &#39;pag&#39; =&gt; 1,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Agregando <tt class="docutils literal"><span class="pre">pag</span></tt> a la clave <tt class="docutils literal"><span class="pre">defaults</span></tt>, el marcador de posición <tt class="docutils literal"><span class="pre">{pag}</span></tt> ya no es necesario. La URL <tt class="docutils literal"><span class="pre">/blog</span></tt> coincidirá con esta ruta y el valor del parámetro <tt class="docutils literal"><span class="pre">pag</span></tt> se fijará en un <tt class="docutils literal"><span class="pre">1</span></tt>. La URL <tt class="docutils literal"><span class="pre">/blog/2</span></tt> también coincide, dando al parámetro <tt class="docutils literal"><span class="pre">pag</span></tt> un valor de <tt class="docutils literal"><span class="pre">2</span></tt>. Perfecto.</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<tbody valign="top">
<tr><td>/blog</td>
<td>{pag} = 1</td>
</tr>
<tr><td>/blog/1</td>
<td>{pag} = 1</td>
</tr>
<tr><td>/blog/2</td>
<td>{pag} = 2</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="agregando-requisitos">
<span id="index-5"></span><h1>Agregando requisitos<a class="headerlink" href="#agregando-requisitos" title="Permalink to this headline">¶</a></h1>
<p>Echa un vistazo a las rutas que hemos creado hasta ahora:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">blog</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{pag}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">index</span><span class="p-Indicator">,</span> <span class="nv">pag</span><span class="p-Indicator">:</span> <span class="nv">1</span> <span class="p-Indicator">}</span>

<span class="l-Scalar-Plain">blog_show</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{ficha}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">show</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{pag}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:index<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;pag&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog_show&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{ficha}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:show<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog&#39;, new Route(&#39;/blog/{pag}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:index&#39;,</span>
<span class="x">    &#39;pag&#39; =&gt; 1,</span>
<span class="x">)));</span>

<span class="x">$coleccion-&gt;add(&#39;blog_show&#39;, new Route(&#39;/blog/{show}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:show&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>¿Puedes ver el problema? Ten en cuenta que ambas rutas tienen patrones que coinciden con las URL que se parezcan a <tt class="docutils literal"><span class="pre">/blog/*</span></tt>. El enrutador de Symfony siempre elegirá la <strong>primera</strong> ruta coincidente que encuentre. En otras palabras, la ruta <tt class="docutils literal"><span class="pre">blog_show</span></tt> <em>nunca</em> corresponderá. En cambio, una URL como <tt class="docutils literal"><span class="pre">/blog/mi-entrada-del-blog</span></tt> coincidirá con la primera ruta (<tt class="docutils literal"><span class="pre">blog</span></tt>) y devolverá un valor sin sentido de <tt class="docutils literal"><span class="pre">mi-entrada-del-blog</span></tt> para el parámetro <tt class="docutils literal"><span class="pre">{pag}</span></tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="11%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">URL</th>
<th class="head">ruta</th>
<th class="head">parámetros</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>/blog/2</td>
<td>blog</td>
<td>{pag} = 2</td>
</tr>
<tr><td>/blog/mi-entrada-del-blog</td>
<td>blog</td>
<td>{pag} = mi-entrada-del-blog</td>
</tr>
</tbody>
</table>
<p>La respuesta al problema es añadir <em>requisitos</em> a la ruta. Las rutas en este ejemplo deben funcionar a la perfección si el patrón <tt class="docutils literal"><span class="pre">/blog/{pag}</span></tt> <em>sólo</em> concuerda con una URL dónde la parte <tt class="docutils literal"><span class="pre">{pag}</span></tt> es un número entero. Afortunadamente, se puede agregar fácilmente una expresión regular de requisitos para cada parámetro. Por ejemplo:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">blog</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/blog/{pag}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeBlogBundle</span><span class="p-Indicator">:</span><span class="nv">Blog</span><span class="p-Indicator">:</span><span class="nv">index</span><span class="p-Indicator">,</span> <span class="nv">pag</span><span class="p-Indicator">:</span> <span class="nv">1</span> <span class="p-Indicator">}</span>
    <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">pag</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">\d+</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;blog&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/blog/{pag}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeBlogBundle:Blog:index<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;pag&quot;</span><span class="nt">&gt;</span>1<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;pag&quot;</span><span class="nt">&gt;</span>\d+<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;blog&#39;, new Route(&#39;/blog/{pag}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeBlogBundle:Blog:index&#39;,</span>
<span class="x">    &#39;pag&#39; =&gt; 1,</span>
<span class="x">), array(</span>
<span class="x">    &#39;pag&#39; =&gt; &#39;\d+&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>El requisito <tt class="docutils literal"><span class="pre">\d+</span></tt> es una expresión regular diciendo que el valor del parámetro <tt class="docutils literal"><span class="pre">{pag}</span></tt> debe ser un dígito (es decir, un número). La ruta <tt class="docutils literal"><span class="pre">blog</span></tt> todavía coincide con una URL como <tt class="docutils literal"><span class="pre">/blog/2</span></tt> (porque 2 es un número), pero ya no concuerda con una URL como <tt class="docutils literal"><span class="pre">/blog/my-blog-pos</span></tt> (porque <tt class="docutils literal"><span class="pre">mi-entrada-del-blog</span></tt> <em>no</em> es un número).</p>
<p>Como resultado, una URL como <tt class="docutils literal"><span class="pre">/blog/mi-entrada-del-blog</span></tt> ahora coincide correctamente con la ruta <tt class="docutils literal"><span class="pre">blog_show</span></tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="16%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">URL</th>
<th class="head">ruta</th>
<th class="head">parámetros</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>/blog/2</td>
<td>blog</td>
<td>{pag} = 2</td>
</tr>
<tr><td>/blog/mi-entrada-del-blog</td>
<td>blog_show</td>
<td>{ficha} = mi-entrada-del-blog</td>
</tr>
</tbody>
</table>
<div class="sidebar">
<p class="first sidebar-title">Las primeras rutas siempre ganan</p>
<p class="last">¿Qué significa todo eso de que el orden de las rutas es muy importante?
Si la ruta <tt class="docutils literal"><span class="pre">blog_show</span></tt> se coloca por encima de la ruta <tt class="docutils literal"><span class="pre">blog</span></tt>, la URL <tt class="docutils literal"><span class="pre">/blog/2</span></tt> coincidiría con <tt class="docutils literal"><span class="pre">blog_show</span></tt> en lugar de <tt class="docutils literal"><span class="pre">blog</span></tt> ya que el parámetro <tt class="docutils literal"><span class="pre">{ficha}</span></tt> de <tt class="docutils literal"><span class="pre">blog_show</span></tt> no tiene ningún requisito. Usando el orden adecuado y requisitos claros, puedes lograr casi cualquier cosa.</p>
</div>
<p>Puesto que el parámetro <tt class="docutils literal"><span class="pre">requirements</span></tt> son expresiones regulares, la complejidad y flexibilidad de cada requisito es totalmente tuya. Supongamos que la página principal de tu aplicación está disponible en dos diferentes idiomas, según la URL:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">portada</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>   <span class="l-Scalar-Plain">/{culture}</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span>  <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Principal</span><span class="p-Indicator">:</span><span class="nv">portada</span><span class="p-Indicator">,</span> <span class="nv">culture</span><span class="p-Indicator">:</span> <span class="nv">en</span> <span class="p-Indicator">}</span>
    <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">culture</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">en|es</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;portada&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/{culture}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeDemoBundle:Principal:portada<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;culture&quot;</span><span class="nt">&gt;</span>en<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;culture&quot;</span><span class="nt">&gt;</span>en|es<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;portada&#39;, new Route(&#39;/{culture}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeDemoBundle:Principal:portada&#39;,</span>
<span class="x">    &#39;culture&#39; =&gt; &#39;en&#39;,</span>
<span class="x">), array(</span>
<span class="x">    &#39;culture&#39; =&gt; &#39;en|es&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Para las peticiones entrantes, la porción <tt class="docutils literal"><span class="pre">{culture}</span></tt> de la dirección se compara con la expresión regular <tt class="docutils literal"><span class="pre">(en|es)</span></tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr><td>/</td>
<td>{culture} = en</td>
</tr>
<tr><td>/en</td>
<td>{culture} = en</td>
</tr>
<tr><td>/es</td>
<td>{culture} = es</td>
</tr>
<tr><td>/fr</td>
<td><em>no coincidirá con esta ruta</em></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="agregando-requisitos-de-metodo-http">
<span id="index-6"></span><h1>Agregando requisitos de método HTTP<a class="headerlink" href="#agregando-requisitos-de-metodo-http" title="Permalink to this headline">¶</a></h1>
<p>Además de la URL, también puedes coincidir con el <em>método</em> de la petición entrante (es decir, GET, HEAD, POST, PUT, DELETE). Supongamos que tienes un formulario de contacto con dos controladores - uno para mostrar el formulario (en una petición GET) y uno para procesar el formulario una vez presentada (en una petición POST). Esto se puede lograr con la siguiente configuración de ruta:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">contacto</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/contacto</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Principal</span><span class="p-Indicator">:</span><span class="nv">contacto</span> <span class="p-Indicator">}</span>
    <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">_method</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">GET</span>

<span class="l-Scalar-Plain">contacto_process</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/contacto</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Principal</span><span class="p-Indicator">:</span><span class="nv">contactoProcess</span> <span class="p-Indicator">}</span>
    <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">_method</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">POST</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;contacto&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/contacto&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeDemoBundle:Principal:contacto<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;_method&quot;</span><span class="nt">&gt;</span>GET<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;/route&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;contact_process&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/contacto&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeDemoBundle:Principal:contactoProcess<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;_method&quot;</span><span class="nt">&gt;</span>POST<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;contacto&#39;, new Route(&#39;/contacto&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeDemoBundle:Principal:contacto&#39;,</span>
<span class="x">), array(</span>
<span class="x">    &#39;_method&#39; =&gt; &#39;GET&#39;,</span>
<span class="x">)));</span>

<span class="x">$coleccion-&gt;add(&#39;contacto_process&#39;, new Route(&#39;/contacto&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeDemoBundle:Principal:contactoProcess&#39;,</span>
<span class="x">), array(</span>
<span class="x">    &#39;_method&#39; =&gt; &#39;POST&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>A pesar de que estas dos rutas tienen patrones idénticos (<tt class="docutils literal"><span class="pre">/contacto</span></tt>), la primera ruta sólo coincidirá con las peticiones GET y la segunda sólo coincidirá con las peticiones POST. Esto significa que puedes mostrar y enviar el formulario a través de la misma URL, mientras usas controladores distintos para las dos acciones.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si no especificas el requisito <tt class="docutils literal"><span class="pre">_method</span></tt>, la ruta coincidirá con todos los <em>métodos</em>.</p>
</div>
<p>Al igual que los otros requisitos, el requisito <tt class="docutils literal"><span class="pre">_method</span></tt> se analiza como una expresión regular. Para hacer coincidir peticiones <tt class="docutils literal"><span class="pre">GET</span></tt> <em>o</em> <tt class="docutils literal"><span class="pre">POST</span></tt>, puedes utilizar <tt class="docutils literal"><span class="pre">GET|POST</span></tt>.</p>
</div>
<div class="section" id="ejemplo-de-enrutado-avanzado">
<span id="advanced-routing-example"></span><span id="index-7"></span><h1>Ejemplo de enrutado avanzado<a class="headerlink" href="#ejemplo-de-enrutado-avanzado" title="Permalink to this headline">¶</a></h1>
<p>En este punto, tienes todo lo necesario para crear una poderosa estructura de enrutado Symfony. El siguiente es un ejemplo de cuán flexible puede ser el sistema de enrutado:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">articulo_show</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/articulos/{culture}/{year}/{titulo}.{_format}</span>
  <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Articulo</span><span class="p-Indicator">:</span><span class="nv">show</span><span class="p-Indicator">,</span> <span class="nv">_format</span><span class="p-Indicator">:</span> <span class="nv">html</span> <span class="p-Indicator">}</span>
  <span class="l-Scalar-Plain">requirements</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">culture</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">en|es</span>
      <span class="l-Scalar-Plain">_format</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">html|rss</span>
      <span class="l-Scalar-Plain">year</span><span class="p-Indicator">:</span>     <span class="l-Scalar-Plain">\d+</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;articulo_show&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/articulos/{culture}/{year}/{titulo}.{_format}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeDemoBundle:Articulo:show<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_format&quot;</span><span class="nt">&gt;</span>html<span class="nt">&lt;/default&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;culture&quot;</span><span class="nt">&gt;</span>en|es<span class="nt">&lt;/requirement&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;_format&quot;</span><span class="nt">&gt;</span>html|rss<span class="nt">&lt;/requirement&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">key=</span><span class="s">&quot;year&quot;</span><span class="nt">&gt;</span>\d+<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;portada&#39;, new Route(&#39;/articulos/{culture}/{year}/{titulo}.{_format}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeDemoBundle:Articulo:show&#39;,</span>
<span class="x">    &#39;_format&#39; =&gt; &#39;html&#39;,</span>
<span class="x">), array(</span>
<span class="x">    &#39;culture&#39; =&gt; &#39;en|es&#39;,</span>
<span class="x">    &#39;_format&#39; =&gt; &#39;html|rss&#39;,</span>
<span class="x">    &#39;year&#39; =&gt; &#39;\d+&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Como hemos visto, esta ruta sólo coincide si la porción <tt class="docutils literal"><span class="pre">{culture}</span></tt> de la URL es o bien <tt class="docutils literal"><span class="pre">en</span></tt> o <tt class="docutils literal"><span class="pre">es</span></tt> y si <tt class="docutils literal"><span class="pre">{year}</span></tt> es un número. Esta ruta también muestra cómo puedes utilizar un punto entre los marcadores de posición en lugar de una barra inclinada. Las URL que coinciden con esta ruta podrían ser:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">/articulos/en/2010/mi-comentario</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/articulos/es/2010/mi-comentario.rss</span></tt></li>
</ul>
</div></blockquote>
<div class="sidebar">
<p class="first sidebar-title">El parámetro especial de enrutado <tt class="docutils literal"><span class="pre">_format</span></tt></p>
<p class="last">Este ejemplo también resalta el parámetro especial de enrutado <tt class="docutils literal"><span class="pre">_format</span></tt>.
Cuando se utiliza este parámetro, el valor coincidente se convierte en el &#8220;formato de la petición&#8221; del objeto <tt class="docutils literal"><span class="pre">Petición</span></tt>. En última instancia, el formato de la petición se usa para cosas tales como establecer el <tt class="docutils literal"><span class="pre">Content-Type</span></tt> de la respuesta (por ejemplo, un formato de petición <tt class="docutils literal"><span class="pre">json</span></tt> se traduce en un <tt class="docutils literal"><span class="pre">Content-Type</span></tt> de <tt class="docutils literal"><span class="pre">application/json</span></tt>).
Este también se puede usar en el controlador para reproducir una plantilla diferente por cada valor de <tt class="docutils literal"><span class="pre">_format</span></tt>. El parámetro <tt class="docutils literal"><span class="pre">_format</span></tt> es una forma muy poderosa para reproducir el mismo contenido en distintos formatos.</p>
</div>
<div class="section" id="patron-de-nomenclatura-para-controladores">
<span id="controller-string-syntax"></span><span id="index-8"></span><h2>Patrón de nomenclatura para controladores<a class="headerlink" href="#patron-de-nomenclatura-para-controladores" title="Permalink to this headline">¶</a></h2>
<p>Cada ruta debe tener un parámetro <tt class="docutils literal"><span class="pre">_controller</span></tt>, el cual determina qué controlador se debe ejecutar cuando dicha ruta se empareje. Este parámetro utiliza un patrón de cadena simple llamado el <em>nombre lógico del controlador</em>, que Symfony asigna a un método y clase PHP específico. El patrón consta de tres partes, cada una separada por dos puntos:</p>
<blockquote>
<div><strong>paquete</strong>:<strong>controlador</strong>:<strong>acción</strong></div></blockquote>
<p>Por ejemplo, un valor <tt class="docutils literal"><span class="pre">_controller</span></tt> de <tt class="docutils literal"><span class="pre">AcmeBlogBundle:Blog:show</span></tt> significa:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Paquete</th>
<th class="head">Clase de controlador</th>
<th class="head">Nombre método</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>AcmeBlogBundle</td>
<td>BlogController</td>
<td>showAction</td>
</tr>
</tbody>
</table>
<p>El controlador podría tener este aspecto:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">// src/Acme/BlogBundle/Controller/BlogController.php</span>

<span class="x">namespace Acme\BlogBundle\Controller;</span>
<span class="x">use Symfony\Bundle\FrameworkBundle\Controller\Controller;</span>

<span class="x">class BlogController extends Controller</span>
<span class="x">{</span>
<span class="x">    public function showAction($ficha)</span>
<span class="x">    {</span>
<span class="x">        // ...</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
</div>
<p>Ten en cuenta que Symfony añade la cadena <tt class="docutils literal"><span class="pre">Controller</span></tt> al nombre de la clase (<tt class="docutils literal"><span class="pre">Blog</span></tt>
=&gt; <tt class="docutils literal"><span class="pre">BlogController</span></tt>) y <tt class="docutils literal"><span class="pre">Action</span></tt> al nombre del método (<tt class="docutils literal"><span class="pre">show</span></tt> =&gt; <tt class="docutils literal"><span class="pre">showAction</span></tt>).</p>
<p>También podrías referirte a este controlador utilizando su nombre de clase y método completamente cualificado: <tt class="docutils literal"><span class="pre">Acme\BlogBundle\Controller\BlogController::showAction</span></tt>.
Pero si sigues algunas simples convenciones, el nombre lógico es más conciso y permite mayor flexibilidad.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Además de utilizar el nombre lógico o el nombre de clase completamente cualificado, Symfony es compatible con una tercera forma de referirse a un controlador. Este método utiliza un solo separador de dos puntos (por ejemplo, <tt class="docutils literal"><span class="pre">service_name:indexAction</span></tt>) y hace referencia al controlador como un servicio (consulta <a class="reference internal" href="../cookbook/controller/service.html"><em>Cómo definir controladores como servicios</em></a>).</p>
</div>
</div>
<div class="section" id="parametros-de-ruta-y-argumentos-del-controlador">
<h2>Parámetros de ruta y argumentos del controlador<a class="headerlink" href="#parametros-de-ruta-y-argumentos-del-controlador" title="Permalink to this headline">¶</a></h2>
<p>Los parámetros de ruta (por ejemplo, <tt class="docutils literal"><span class="pre">{ficha}</span></tt>) son especialmente importantes porque cada uno se pone a disposición como argumento para el método controlador:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">public function showAction($ficha)</span>
<span class="x">{</span>
<span class="x">  // ...</span>
<span class="x">}</span>
</pre></div>
</div>
<p>En realidad, toda la colección <tt class="docutils literal"><span class="pre">defaults</span></tt> se combina con los valores del parámetro para formar una sola matriz. Cada clave de esa matriz está disponible como un argumento en el controlador.</p>
<p>En otras palabras, por cada argumento de tu método controlador, Symfony busca un parámetro de ruta de ese nombre y asigna su valor a ese argumento.
En el ejemplo avanzado anterior, cualquier combinación (en cualquier orden) de las siguientes variables se podría utilizar como argumentos para el método <tt class="docutils literal"><span class="pre">showAction()</span></tt>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">$culture</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$year</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$titulo</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$_format</span></tt></li>
<li><tt class="docutils literal"><span class="pre">$_controller</span></tt></li>
</ul>
<p>Dado que los marcadores de posición y los valores de la colección <tt class="docutils literal"><span class="pre">defaults</span></tt> se combinan, incluso la variable <tt class="docutils literal"><span class="pre">$_controller</span></tt> está disponible. Para una explicación más detallada, consulta <a class="reference internal" href="controller.html#route-parameters-controller-arguments"><em>Parámetros de ruta como argumentos para el controlador</em></a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">También puedes utilizar una variable especial <tt class="docutils literal"><span class="pre">$_route</span></tt>, que se fija al nombre de la ruta que se emparejó.</p>
</div>
</div>
<div class="section" id="incluyendo-recursos-de-enrutado-externos">
<span id="routing-include-external-resources"></span><span id="index-9"></span><h2>Incluyendo recursos de enrutado externos<a class="headerlink" href="#incluyendo-recursos-de-enrutado-externos" title="Permalink to this headline">¶</a></h2>
<p>Todas las rutas se cargan a través de un único archivo de configuración - usualmente <tt class="docutils literal"><span class="pre">app/config/routing.yml</span></tt> (consulta <a class="reference internal" href="#creando-rutas">Creando rutas</a> más arriba). Por lo general, sin embargo, deseas cargar rutas para otros lugares, como un archivo de enrutado que vive dentro de un paquete. Esto se puede hacer &#8220;importando&#8221; ese archivo:</p>
<div class="configuration-block">
<ul class="simple">
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cuando importas recursos desde YAML, la clave (por ejemplo, <tt class="docutils literal"><span class="pre">acme_hola</span></tt>) no tiene sentido.
Sólo asegúrate de que es única para que no haya otras líneas que reemplazar.</p>
</div>
<p>La clave <tt class="docutils literal"><span class="pre">resource</span></tt> carga el recurso dado enrutando. En este ejemplo, el recurso es la ruta completa a un archivo, donde la sintaxis contextual del atajo <tt class="docutils literal"><span class="pre">&#64;AcmeHolaBundle</span></tt> se resuelve en la ruta a ese paquete. El archivo importado podría tener este aspecto:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre> <span class="c1"># src/Acme/HolaBundle/Resources/config/routing.yml</span>
<span class="l-Scalar-Plain">acme_hola</span><span class="p-Indicator">:</span>
     <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/hola/{nombre}</span>
     <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeHolaBundle</span><span class="p-Indicator">:</span><span class="nv">Hola</span><span class="p-Indicator">:</span><span class="nv">index</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- src/Acme/HolaBundle/Resources/config/routing.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>

<span class="nt">&lt;routes</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/routing&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;route</span> <span class="na">id=</span><span class="s">&quot;acme_hola&quot;</span> <span class="na">pattern=</span><span class="s">&quot;/hola/{nombre}&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;default</span> <span class="na">key=</span><span class="s">&quot;_controller&quot;</span><span class="nt">&gt;</span>AcmeHolaBundle:Hola:index<span class="nt">&lt;/default&gt;</span>
    <span class="nt">&lt;/route&gt;</span>
<span class="nt">&lt;/routes&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">// src/Acme/HolaBundle/Resources/config/routing.php</span>
<span class="x">use Symfony\Component\Routing\RouteCollection;</span>
<span class="x">use Symfony\Component\Routing\Route;</span>

<span class="x">$coleccion = new RouteCollection();</span>
<span class="x">$coleccion-&gt;add(&#39;acme_hola&#39;, new Route(&#39;/Hola/{nombre}&#39;, array(</span>
<span class="x">    &#39;_controller&#39; =&gt; &#39;AcmeHolaBundle:Hola:index&#39;,</span>
<span class="x">)));</span>

<span class="x">return $coleccion;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Las rutas de este archivo se analizan y cargan en la misma forma que el archivo de enrutado principal.</p>
</div>
</div>
<div class="section" id="prefijando-rutas-importadas">
<h1>Prefijando rutas importadas<a class="headerlink" href="#prefijando-rutas-importadas" title="Permalink to this headline">¶</a></h1>
<p>También puedes optar por proporcionar un &#8220;prefijo&#8221; para las rutas importadas. Por ejemplo, supongamos que deseas que la ruta <tt class="docutils literal"><span class="pre">acme_hola</span></tt> tenga un patrón final de <tt class="docutils literal"><span class="pre">/admin/hola/{nombre}</span></tt> en lugar de simplemente <tt class="docutils literal"><span class="pre">/hola/{nombre}</span></tt>:</p>
<div class="configuration-block">
<ul class="simple">
</ul>
</div>
<p>La cadena <tt class="docutils literal"><span class="pre">/admin</span></tt> ahora se antepondrá al patrón de cada ruta cargada desde el nuevo recurso enrutado.</p>
<div class="section" id="visualizando-y-depurando-rutas">
<span id="index-10"></span><h2>Visualizando y depurando rutas<a class="headerlink" href="#visualizando-y-depurando-rutas" title="Permalink to this headline">¶</a></h2>
<p>Si bien agregar y personalizar rutas, es útil para poder visualizar y obtener información detallada sobre tus rutas. Una buena manera de ver todas las rutas en tu aplicación es a través de la orden de consola <tt class="docutils literal"><span class="pre">router:debug</span></tt>. Ejecuta la siguiente orden desde la raíz de tu proyecto.</p>
<div class="highlight-bash"><div class="highlight"><pre>php app/console router:debug
</pre></div>
</div>
<p>Esta orden imprimirá una útil lista de <em>todas</em> las rutas configuradas en tu aplicación:</p>
<div class="highlight-text"><div class="highlight"><pre>portada               ANY       /
contact               GET       /contacto
contact_process       POST      /contacto
articulo_show         ANY       /articulos/{culture}/{year}/{titulo}.{_format}
blog                  ANY       /blog/{pag}
blog_show             ANY       /blog/{ficha}
</pre></div>
</div>
<p>También puedes obtener información muy específica de una sola ruta incluyendo el nombre de la ruta después de la orden:</p>
<div class="highlight-bash"><div class="highlight"><pre>php app/console router:debug articulo_show
</pre></div>
</div>
</div>
<div class="section" id="generando-url">
<span id="index-11"></span><h2>Generando URL<a class="headerlink" href="#generando-url" title="Permalink to this headline">¶</a></h2>
<p>El sistema de enrutado también se debe utilizar para generar direcciones URL. En realidad, el enrutado es un sistema bidireccional: asignando la URL a un controlador+parámetros y la ruta+parámetros a una URL. Los métodos <a href="#id1"><span class="problematic" id="id2">:method:`Symfony\\Component\\Routing\\Router::match`</span></a> y <a href="#id3"><span class="problematic" id="id4">:method:`Symfony\\Component\\Routing\\Router::generate`</span></a> de este sistema bidireccional. Tomando la ruta <tt class="docutils literal"><span class="pre">blog_show</span></tt> del ejemplo anterior:</p>
<div class="highlight-python"><pre>$params = $enrutador-&gt;match('/blog/mi-entrada-del-blog');
// array('ficha' =&gt; 'mi-entrada-del-blog', '_controller' =&gt; 'AcmeBlogBundle:Blog:show')

$uri = $enrutador-&gt;generate('blog_show', array('ficha' =&gt; 'mi-entrada-del-blog'));
// /blog/mi-entrada-del-blog</pre>
</div>
<p>Para generar una URL, debes especificar el nombre de la ruta (por ejemplo, <tt class="docutils literal"><span class="pre">blog_show</span></tt>) y ningún comodín (por ejemplo, <tt class="docutils literal"><span class="pre">ficha</span> <span class="pre">=</span> <span class="pre">mi-entrada-del-blog</span></tt>) utilizados en el patrón para esa ruta. Con esta información, puedes generar fácilmente cualquier URL:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">class PrincipalController extends Controller</span>
<span class="x">{</span>
<span class="x">    public function showAction($ficha)</span>
<span class="x">    {</span>
<span class="x">      // ...</span>

<span class="x">      $url = $this-&gt;get(&#39;router&#39;)-&gt;generate(&#39;blog_show&#39;, array(&#39;ficha&#39; =&gt; &#39;mi-entrada-del-blog&#39;));</span>
<span class="x">    }</span>
<span class="x">}</span>
</pre></div>
</div>
<p>En una sección posterior, aprenderás cómo generar direcciones URL desde dentro de plantillas.</p>
</div>
</div>
<div class="section" id="generando-url-absolutas">
<span id="index-12"></span><h1>Generando URL absolutas<a class="headerlink" href="#generando-url-absolutas" title="Permalink to this headline">¶</a></h1>
<p>De forma predeterminada, el enrutador va a generar direcciones URL relativas (por ejemplo <tt class="docutils literal"><span class="pre">/blog</span></tt>). Para generar una URL absoluta, sólo tienes que pasar <tt class="docutils literal"><span class="pre">true</span></tt> como tercer argumento del método <tt class="docutils literal"><span class="pre">generate()</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$enrutador-&gt;generate(&#39;blog_show&#39;, array(&#39;ficha&#39; =&gt; &#39;mi-entrada-del-blog&#39;), true);</span>
<span class="x">// http://www.ejemplo.com/blog/mi-entrada-del-blog</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>El host que utiliza al generar una URL absoluta es el anfitrión del objeto <tt class="docutils literal"><span class="pre">Petición</span></tt> actual. Este, de forma automática, lo detecta basándose en la información del servidor proporcionada por PHP. Al generar direcciones URL absolutas para archivos desde la línea de ordenes, tendrás que configurar manualmente el anfitrión que desees en el objeto <tt class="docutils literal"><span class="pre">Petición</span></tt>:</p>
<div class="last highlight-php"><div class="highlight"><pre><span class="x">$peticion-&gt;headers-&gt;set(&#39;HOST&#39;, &#39;www.ejemplo.com&#39;);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="generando-url-con-cadena-de-consulta">
<span id="index-13"></span><h1>Generando URL con cadena de consulta<a class="headerlink" href="#generando-url-con-cadena-de-consulta" title="Permalink to this headline">¶</a></h1>
<p>El método <tt class="docutils literal"><span class="pre">generate</span></tt> toma una matriz de valores comodín para generar la URI.
Pero si pasas adicionales, se añadirán a la URI como cadena de consulta:</p>
<div class="highlight-python"><pre>$enrutador-&gt;generate('blog', array('pag' =&gt; 2, 'categoria' =&gt; 'Symfony'));
// /blog/2?categoria=Symfony</pre>
</div>
</div>
<div class="section" id="generando-url-desde-una-plantilla">
<h1>Generando URL desde una plantilla<a class="headerlink" href="#generando-url-desde-una-plantilla" title="Permalink to this headline">¶</a></h1>
<p>El lugar más común para generar una URL es dentro de una plantilla cuando creas enlaces entre las páginas de tu aplicación. Esto se hace igual que antes, pero utilizando una función ayudante de plantilla:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">path</span><span class="o">(</span><span class="s1">&#39;blog_show&#39;</span><span class="o">,</span> <span class="o">{</span> <span class="s1">&#39;ficha&#39;</span><span class="o">:</span> <span class="s1">&#39;mi-entrada-del-blog&#39;</span> <span class="o">})</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
  Leer esta entrada del blog.
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;blog_show&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;ficha&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mi-entrada-del-blog&#39;</span><span class="p">))</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">    Leer esta entrada del blog.</span>
<span class="x">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>También se pueden generar URL absolutas.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>Twig</em><div class="highlight-html+jinja"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url</span><span class="o">(</span><span class="s1">&#39;blog_show&#39;</span><span class="o">,</span> <span class="o">{</span> <span class="s1">&#39;ficha&#39;</span><span class="o">:</span> <span class="s1">&#39;mi-entrada-del-blog&#39;</span> <span class="o">})</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="nt">&gt;</span>
  Leer esta entrada del blog.
<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="x">&lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$view</span><span class="p">[</span><span class="s1">&#39;router&#39;</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">generate</span><span class="p">(</span><span class="s1">&#39;blog_show&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;ficha&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mi-entrada-del-blog&#39;</span><span class="p">),</span> <span class="k">true</span><span class="p">)</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">    Leer esta entrada del blog.</span>
<span class="x">&lt;/a&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="resumen">
<h2>Resumen<a class="headerlink" href="#resumen" title="Permalink to this headline">¶</a></h2>
<p>El enrutado es un sistema para asignar la dirección de las peticiones entrantes a la función controladora que se debe llamar para procesar la petición. Este permite especificar ambas direcciones URL bonitas y mantiene la funcionalidad de tu aplicación disociada de las direcciones URL. El enrutado es un mecanismo de dos vías, lo cual significa que también se debe usar para generar direcciones URL.</p>
</div>
<div class="section" id="aprende-mas-en-el-recetario">
<h2>Aprende más en el recetario<a class="headerlink" href="#aprende-mas-en-el-recetario" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../cookbook/routing/scheme.html"><em>Cómo forzar las rutas para utilizar siempre HTTPS</em></a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Enrutando</a><ul>
<li><a class="reference internal" href="#enrutador-en-accion">Enrutador en acción</a></li>
<li><a class="reference internal" href="#enrutador-bajo-el-capo">Enrutador: bajo el capó</a></li>
<li><a class="reference internal" href="#creando-rutas">Creando rutas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuracion-basica-de-rutas">Configuración básica de rutas</a></li>
<li><a class="reference internal" href="#enrutando-con-marcadores-de-posicion">Enrutando con marcadores de posición</a></li>
<li><a class="reference internal" href="#marcadores-de-posicion-obligatorios-y-opcionales">Marcadores de posición obligatorios y opcionales</a></li>
<li><a class="reference internal" href="#agregando-requisitos">Agregando requisitos</a></li>
<li><a class="reference internal" href="#agregando-requisitos-de-metodo-http">Agregando requisitos de método HTTP</a></li>
<li><a class="reference internal" href="#ejemplo-de-enrutado-avanzado">Ejemplo de enrutado avanzado</a><ul>
<li><a class="reference internal" href="#patron-de-nomenclatura-para-controladores">Patrón de nomenclatura para controladores</a></li>
<li><a class="reference internal" href="#parametros-de-ruta-y-argumentos-del-controlador">Parámetros de ruta y argumentos del controlador</a></li>
<li><a class="reference internal" href="#incluyendo-recursos-de-enrutado-externos">Incluyendo recursos de enrutado externos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prefijando-rutas-importadas">Prefijando rutas importadas</a><ul>
<li><a class="reference internal" href="#visualizando-y-depurando-rutas">Visualizando y depurando rutas</a></li>
<li><a class="reference internal" href="#generando-url">Generando URL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#generando-url-absolutas">Generando URL absolutas</a></li>
<li><a class="reference internal" href="#generando-url-con-cadena-de-consulta">Generando URL con cadena de consulta</a></li>
<li><a class="reference internal" href="#generando-url-desde-una-plantilla">Generando URL desde una plantilla</a><ul>
<li><a class="reference internal" href="#resumen">Resumen</a></li>
<li><a class="reference internal" href="#aprende-mas-en-el-recetario">Aprende más en el recetario</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="controller.html"
                        title="previous chapter">Controlador</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="templating.html"
                        title="next chapter">Creando y usando plantillas</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/book/routing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="templating.html" title="Creando y usando plantillas"
             >next</a> |</li>
        <li class="right" >
          <a href="controller.html" title="Controlador"
             >previous</a> |</li>
        <li><a href="../index.html">symfony-docs-es v1 documentation</a> &raquo;</li>
          <li><a href="index.html" >Libro</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Osukaru.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>